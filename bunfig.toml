# Bun Configuration File
# https://bun.sh/docs/runtime/bunfig

[test]
# Test discovery patterns (Bun's default patterns)
# *.test.{js|jsx|ts|tsx}
# *_test.{js|jsx|ts|tsx}
# *.spec.{js|jsx|ts|tsx}
# *_spec.{js|jsx|ts|tsx}

# Root directory for test discovery
root = "tests"

# Preload scripts for global test setup
preload = ["./tests/setup.ts"]

# Coverage configuration
coverage = true
coverageSkipTestFiles = true  # Exclude test files from coverage

# Coverage thresholds (90% for all metrics)
coverageThreshold = { line = 0.9, function = 0.9, statement = 0.9 }

# Test execution configuration
randomize = true  # Randomize test order to catch dependencies
rerunEach = 1    # Number of times to rerun each test file

# Timeout configuration (15 seconds for API calls)
timeout = 15000

# Enable concurrent test execution for better performance
# Tests will run concurrently unless marked with .serial

# Enable smol mode for reduced memory usage
smol = false  # Keep false for better performance in CI

# Test file patterns for concurrent execution
# Run integration tests concurrently, unit tests sequentially
concurrentTestGlob = [
  "**/integration/*.test.ts",
  "**/e2e/*.test.ts"
]

# Reporter configuration
# Default reporter is used, can be overridden with CLI flags

# Environment variables for tests
[test.env]
NODE_ENV = "test"
CI = "true"
